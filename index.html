<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>PRTS: Strategic Deployment</title>
    <link rel="stylesheet" href="style.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js" defer></script>
</head>
<body>
    <div class="container">
        <nav class="main-nav">
            <button class="nav-btn active" data-target="main-page">編成生成</button>
            <button class="nav-btn" data-target="manage-page">所持キャラ管理</button>
            <button class="nav-btn" data-target="guide-page">使い方</button>
        </nav>

        <div id="main-page" class="page active">
            <h1>PRTS: 拠点防衛編成</h1>
            <div class="controls">
                <div class="deployment-settings">
                    <div class="config-left">
                        <div class="total-config">
                            <label class="section-label">合計人数</label>
                            <input type="number" id="max-squad-size" value="12" min="1" max="12" class="huge-input">
                        </div>
                        <div class="options-config">
                            <label class="section-label">オプション</label>
                            <div class="rarity-checks">
                                <label><input type="checkbox" class="rarity-check" value="6" checked><span>★6</span></label>
                                <label><input type="checkbox" class="rarity-check" value="5" checked><span>★5</span></label>
                                <label><input type="checkbox" class="rarity-check" value="4" checked><span>★4</span></label>
                                <label><input type="checkbox" class="rarity-check" value="3" checked><span>★3-1</span></label>
                            </div>
                            <label class="toggle-label"><input type="checkbox" id="owned-only-check" checked> 所持済み限定</label>
                        </div>
                    </div>

                    <div class="class-config">
                        <label class="section-label">職種別・確定枠指定</label>
                        <div class="class-input-grid">
                            <div class="input-item"><span>先鋒</span><input type="number" class="class-input" data-class="先鋒" value="0"></div>
                            <div class="input-item"><span>前衛</span><input type="number" class="class-input" data-class="前衛" value="0"></div>
                            <div class="input-item"><span>狙撃</span><input type="number" class="class-input" data-class="狙撃" value="0"></div>
                            <div class="input-item"><span>重装</span><input type="number" class="class-input" data-class="重装" value="0"></div>
                            <div class="input-item"><span>医療</span><input type="number" class="class-input" data-class="医療" value="0"></div>
                            <div class="input-item"><span>補助</span><input type="number" class="class-input" data-class="補助" value="0"></div>
                            <div class="input-item"><span>術師</span><input type="number" class="class-input" data-class="術師" value="0"></div>
                            <div class="input-item"><span>特殊</span><input type="number" class="class-input" data-class="特殊" value="0"></div>
                        </div>
                    </div>
                </div>
                <div class="status-options">
                    <button id="generate-btn" class="main-generate-btn">作戦開始</button>
                </div>
            </div>
            <div id="squad-display" class="results-layout"></div>
            <div id="share-actions" class="share-actions" style="display: none;">
                <button id="download-btn" class="action-btn dl">画像を保存</button>
                <button id="share-x-btn" class="action-btn x">Xで共有</button>
                <button id="share-bsky-btn" class="action-btn bsky">Blueskyで共有</button>
            </div>
            <a id="download-link" style="display:none;"></a>
        </div>

        <div id="manage-page" class="page">
            <h1>所持キャラ管理</h1>
            <div class="manage-controls">
                <div class="sub-tabs rarity-tabs">
                    <button class="sub-tab-btn active" data-rarity="6">★6</button>
                    <button class="sub-tab-btn" data-rarity="5">★5</button>
                    <button class="sub-tab-btn" data-rarity="4">★4</button>
                    <button class="sub-tab-btn" data-rarity="3">★3-1</button>
                </div>
                <div class="sub-tabs class-tabs">
                    <button class="class-tab active" data-class="all">全職</button>
                    <button class="class-tab" data-class="先鋒">先鋒</button>
                    <button class="class-tab" data-class="前衛">前衛</button>
                    <button class="class-tab" data-class="狙撃">狙撃</button>
                    <button class="class-tab" data-class="重装">重装</button>
                    <button class="class-tab" data-class="医療">医療</button>
                    <button class="class-tab" data-class="補助">補助</button>
                    <button class="class-tab" data-class="術師">術師</button>
                    <button class="class-tab" data-class="特殊">特殊</button>
                </div>
                <div class="bulk-actions">
                    <button id="all-owned-btn" class="action-btn-small">一括選択</button>
                    <button id="all-unowned-btn" class="action-btn-small secondary">一括解除</button>
                </div>
            </div>
            <div id="operator-list" class="manage-grid"></div>
        </div>

        <div id="guide-page" class="page">
            <h1>操作ガイド</h1>
            <div class="guide-content">
                <section class="guide-section">
                    <h2>1. 所持キャラの登録</h2>
                    <p>「所持キャラ管理」タブで、育成済みのキャラをタップして有効化してください。一括選択ボタンでレアリティごとにまとめて登録も可能です。</p>
                </section>
                <section class="guide-section">
                    <h2>2. 条件を指定して生成</h2>
                    <p>「編成生成」タブで合計人数や職種ごとの確定枠を入力し、「作戦開始」をクリック。ランダムに編成が組まれます。</p>
                </section>
                <section class="guide-section">
                    <h2>3. 個別に再抽選</h2>
                    <p>生成された編成画面で、<strong>キャラのアイコンを直接クリック</strong>すると、その枠だけを別のキャラに再抽選できます。</p>
                </section>
                <section class="guide-section">
                    <h2>4. 保存と共有</h2>
                    <p>「画像を保存」から結果を保存できます。iPhoneの方は別タブが開くので、画像を長押しして保存してください。</p>
                </section>
            </div>
        </div>

        <footer class="footer-contact">
            <p>お問い合わせ・ご要望はこちら</p>
            <div class="footer-links">
                <a href="https://x.com/noza0677" target="_blank" rel="noopener">X: @noza0677</a>
                <a href="https://marshmallow-qa.com/272n6zjlsy9kbtk" target="_blank" rel="noopener">マシュマロ</a>
            </div>
        </footer>
    </div>
    <script type="module" src="script.js"></script>
</body>
</html>